import{u as P,c as q,a as p,j as n,r as v,L as E}from"./main-sixty-windows-relax.js";import{P as m,p as T}from"./PlatformIcon-DQwuZFOE.js";import{S as C,T as j,F as N,A as B,j as G,r as d,Q as V,u as z,I as D}from"./antd-Biwa_WcY.js";import{c as w}from"./react-query-DTccfBeP.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function ie(){const{isProClient:e}=P(q),t=[{value:"minute",label:"Minute"},{value:"hour",label:"Hour"}],a=[{value:"minute",label:"Minute"},{value:"hour",label:"Hour"},{value:"day",label:"Day"},{value:"week",label:"Week"},{value:"month",label:"Month"},{value:"year",label:"Year"}];return e?a:t}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function oe({iconSize:e=50,textLevel:t=3}){return p(N,{className:"py-3",style:{height:"140px"},align:"center",justify:"center",gap:20,vertical:!0,children:[p(C,{children:[n(m,{size:e,name:"facebook"}),n(m,{size:e,name:"twitter"}),n(m,{size:e,name:"pinterest"}),n(m,{size:e,name:"googleBusinessProfile"})]}),n(j.Title,{level:t,children:"Connect your social account first!"})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function F(){const{data:e,isLoading:t,refetch:a}=w({queryKey:["groups"],queryFn:async()=>v("groups",void 0,void 0,"GET")});return{groups:(e==null?void 0:e.data)||[],isLoadingGroups:t,refetchGroups:a}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function H(){const{data:e,isLoading:t,refetch:a}=w({queryKey:["active-accounts"],queryFn:async()=>v("active-accounts",void 0,void 0,"GET")});return{activeAccounts:(e==null?void 0:e.data)||[],isLoadingActiveAccounts:t,refetchActiveAccounts:a}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:Q}=j;function k({name:e,img:t}){return n(G,{justify:"space-between",children:p(C,{children:[n(B,{shape:"square",src:t}),n(Q,{children:e})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const A=(e,t,a,c,i)=>e!==""&&t==="all"||a?c.filter(s=>s.platform===a&&s.details.account_name.toLowerCase().includes(e)):t==="tags"?e!==""?i.filter(s=>s.name.includes(e)):i:c.filter(s=>s.platform===a),S=e=>[...new Set(e.map(t=>t.platform))],O=(e,t,a)=>a&&e==="tags"?a.map(c=>`tag-${c}`):t&&e==="all"?t.map(c=>`account-${c}`):t?t.map(c=>`account-${c}`):[],R=(e,t,a,c)=>t.filter(i=>e.includes(String(i.id))).map(i=>{const s=`account-${a}-${i.id}`;return c.push(s),{title:n(k,{name:i.details.account_name,img:i.details.icon}),key:s,checkable:!1}}),W=(e,t,a,c)=>{let i=[],s=[];return i=t==="tags"?[{title:"All tags",key:"tags",children:A(e,t,"",a,c).map(l=>{const u=`tag-${l.id}`;s.push(u);const h="account_ids"in l?l.account_ids.split(","):[];return{title:"name"in l&&l.name,key:u,children:R(h,a,u,s)}})}]:[{title:"Select All",key:"all",children:S(a).map(l=>{var u;return s.push(l),{title:(u=T[l])==null?void 0:u.name,key:l,style:e!==""&&!A(e,t,l,a,c).length||t!==l&&t!=="all"?{display:" none"}:{},children:A(e,t,l,a,c).map(h=>{const f=`account-${h.id}`;return{title:"details"in h&&n(k,{name:h.details.account_name,img:h.details.icon}),key:f,disabled:t!=="all"&&t!==l}})}})}],t==="all"&&s.push(t),t!=="all"&&t!=="tags"&&(s=["all",t]),{treeData:i,expandKeys:s}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};var Y={name:"1mcunxu",styles:"min-height:100%"},J={name:"w5cnao",styles:"width:100%;margin:4px 0"};function re({selectedAccount:e,setSelectedAccount:t,isLoading:a}){const[c,i]=d.useState("all"),{groups:s}=F(),{activeAccounts:l}=H(),[u,h]=d.useState(""),f=d.useMemo(()=>O(c,e.accountIds,e.tagIds),[c,e]),I=d.useMemo(()=>S(l).map(r=>({label:T[r].name,value:r})),[l]),{treeData:y,expandKeys:M}=d.useMemo(()=>W(u,c,l,s),[c,l,u]),x=[{label:"All Accounts",value:"all"},{label:"All Tags",value:"tags"},...I];return p("div",{css:Y,children:[n(z,{css:J,defaultValue:c,onChange:r=>{i(r)},options:x}),n(D,{className:"my-1",placeholder:"Search",size:"small",prefix:n(E,{name:"search"}),allowClear:!0,onChange:r=>{const g=r.target.value.toLowerCase();h(g)}}),n(V,{disabled:a,checkable:!0,selectable:!1,onCheck:r=>{const g=Array.isArray(r)?r:r.checked,b=s.filter(o=>g.includes(`tag-${o.id}`)).map(o=>Number(o.id)),$=s.filter(o=>b.includes(Number(o.id))).map(o=>o.account_ids),K=[...new Set($.flatMap(o=>o.split(",").map(Number)))],L=[...l.filter(o=>g.includes(`account-${o.id}`)).map(o=>o.id),...K],_={accountIds:[...new Set(L)],tagIds:b};t(_)},checkedKeys:f,treeData:y,expandedKeys:M,defaultExpandAll:!0,blockNode:!0,autoExpandParent:!0},y.length)]})}export{re as A,H as a,oe as b,ie as u};
