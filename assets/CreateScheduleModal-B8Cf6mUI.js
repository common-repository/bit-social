import{f as te,g as Q,e as ae,l as V,r as K,j as a,a as $,A as Me,m as Ie,h as x,F as Y,p as M,u as R,c as se,b as je,d as xe,L as Fe}from"./main-sixty-windows-relax.js";import{z as de,G as ge,y as w,v as me,I as ce,p as k,S as E,u as H,T as W,n as Ye,H as Le,t as fe,r as N,q as Oe,J as ze,K as Ee,N as pe,F as He,i as re,j as Ne,B as J,M as Ue}from"./antd-Biwa_WcY.js";import{$ as be,M as ye}from"./index-C5LbIB16.js";import{c as Ce,u as Be,a as oe}from"./react-query-DTccfBeP.js";import{u as qe}from"./useSocialTemplates-BiyAeAy2.js";import{$ as Te,D as Ze}from"./DatePicker-DXK_nakB.js";import{u as Ve}from"./router-C23xx3cB.js";import{a as ve}from"./css-in-js-CSGOT-6T.js";import{u as Ke,a as Re,A as We,b as Ge}from"./AccountTree-BRMqFSA0.js";import{u as Qe}from"./usePostTypes-DclIDgT5.js";import{u as Je,C as le}from"./ConnectAccount-C_KvEdD2.js";import{P as Xe}from"./PlatformIcon-DQwuZFOE.js";import"./isPro-Cd6vIDhm.js";import{C as et}from"./CronWarning-CxT7V9W3.js";var Ae={exports:{}};(function(e,t){(function(o,h){e.exports=h()})(de,function(){var o={year:0,month:1,day:2,hour:3,minute:4,second:5},h={};return function(p,T,m){var S,c=function(r,g,u){u===void 0&&(u={});var s=new Date(r),i=function(l,f){f===void 0&&(f={});var d=f.timeZoneName||"short",C=l+"|"+d,n=h[C];return n||(n=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:l,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:d}),h[C]=n),n}(g,u);return i.formatToParts(s)},v=function(r,g){for(var u=c(r,g),s=[],i=0;i<u.length;i+=1){var l=u[i],f=l.type,d=l.value,C=o[f];C>=0&&(s[C]=parseInt(d,10))}var n=s[3],y=n===24?0:n,_=s[0]+"-"+s[1]+"-"+s[2]+" "+y+":"+s[4]+":"+s[5]+":000",D=+r;return(m.utc(_).valueOf()-(D-=D%1e3))/6e4},b=T.prototype;b.tz=function(r,g){r===void 0&&(r=S);var u,s=this.utcOffset(),i=this.toDate(),l=i.toLocaleString("en-US",{timeZone:r}),f=Math.round((i-new Date(l))/1e3/60),d=15*-Math.round(i.getTimezoneOffset()/15)-f;if(!Number(d))u=this.utcOffset(0,g);else if(u=m(l,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(d,!0),g){var C=u.utcOffset();u=u.add(s-C,"minute")}return u.$x.$timezone=r,u},b.offsetName=function(r){var g=this.$x.$timezone||m.tz.guess(),u=c(this.valueOf(),g,{timeZoneName:r}).find(function(s){return s.type.toLowerCase()==="timezonename"});return u&&u.value};var A=b.startOf;b.startOf=function(r,g){if(!this.$x||!this.$x.$timezone)return A.call(this,r,g);var u=m(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return A.call(u,r,g).tz(this.$x.$timezone,!0)},m.tz=function(r,g,u){var s=u&&g,i=u||g||S,l=v(+m(),i);if(typeof r!="string")return m(r).tz(i);var f=function(y,_,D){var P=y-60*_*1e3,F=v(P,D);if(_===F)return[P,_];var U=v(P-=60*(F-_)*1e3,D);return F===U?[P,F]:[y-60*Math.min(F,U)*1e3,Math.max(F,U)]}(m.utc(r,s).valueOf(),l,i),d=f[0],C=f[1],n=m(d).utcOffset(C);return n.$x.$timezone=i,n},m.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},m.tz.setDefault=function(r){S=r}}})})(Ae);var tt=Ae.exports;const _e=ge(tt);var $e={exports:{}};(function(e,t){(function(o,h){e.exports=h()})(de,function(){var o="minute",h=/[+-]\d\d(?::?\d\d)?/g,p=/([+-]|\d\d)/g;return function(T,m,S){var c=m.prototype;S.utc=function(s){var i={date:s,utc:!0,args:arguments};return new m(i)},c.utc=function(s){var i=S(this.toDate(),{locale:this.$L,utc:!0});return s?i.add(this.utcOffset(),o):i},c.local=function(){return S(this.toDate(),{locale:this.$L,utc:!1})};var v=c.parse;c.parse=function(s){s.utc&&(this.$u=!0),this.$utils().u(s.$offset)||(this.$offset=s.$offset),v.call(this,s)};var b=c.init;c.init=function(){if(this.$u){var s=this.$d;this.$y=s.getUTCFullYear(),this.$M=s.getUTCMonth(),this.$D=s.getUTCDate(),this.$W=s.getUTCDay(),this.$H=s.getUTCHours(),this.$m=s.getUTCMinutes(),this.$s=s.getUTCSeconds(),this.$ms=s.getUTCMilliseconds()}else b.call(this)};var A=c.utcOffset;c.utcOffset=function(s,i){var l=this.$utils().u;if(l(s))return this.$u?0:l(this.$offset)?A.call(this):this.$offset;if(typeof s=="string"&&(s=function(n){n===void 0&&(n="");var y=n.match(h);if(!y)return null;var _=(""+y[0]).match(p)||["-",0,0],D=_[0],P=60*+_[1]+ +_[2];return P===0?0:D==="+"?P:-P}(s),s===null))return this;var f=Math.abs(s)<=16?60*s:s,d=this;if(i)return d.$offset=f,d.$u=s===0,d;if(s!==0){var C=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(d=this.local().add(f+C,o)).$offset=f,d.$x.$localOffset=C}else d=this.utc();return d};var r=c.format;c.format=function(s){var i=s||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return r.call(this,i)},c.valueOf=function(){var s=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*s},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var g=c.toDate;c.toDate=function(s){return s==="s"&&this.$offset?S(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var u=c.diff;c.diff=function(s,i,l){if(s&&this.$u===s.$u)return u.call(this,s,i,l);var f=this.local(),d=S(s).local();return u.call(f,d,i,l)}}})})($e);var at=$e.exports;const Se=ge(at);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const st=globalThis.jotaiAtomCache.get("/home/runner/work/bit-social/bit-social/frontend/src/common/globalStates/$scheduleModalData.ts/$scheduleModalData",te({open:!1,type:"Create"}));st.debugLabel="$scheduleModalData";const De=globalThis.jotaiAtomCache.get("/home/runner/work/bit-social/bit-social/frontend/src/common/globalStates/$scheduleModalData.ts/$searchText",te(""));De.debugLabel="$searchText";w.extend(Se);w.extend(_e);const{timeZone:ot}=Q(ae),it=Q(be),nt=w(V(ot)).format("YYYY-MM-DD HH:mm:ss"),ct=e=>({facebook:{content:e.facebook.content,isFeaturedImage:!1,isProductImage:!1,isLinkCard:!1,isAllImages:!1,isVideo:!1},linkedin:{content:e.linkedin.content,isFeaturedImage:!1,isProductImage:!1,isLinkCard:!1,isAllImages:!1,isVideo:!1},twitter:{content:e.twitter.content,isFeaturedImage:!1,isProductImage:!1,isLinkCard:!1,isAllImages:!1},pinterest:{content:e.pinterest.content,isFeaturedImage:!0,isProductImage:!1,isAllImages:!1},discord:{content:e.discord.content,isFeaturedImage:!0,isProductImage:!1,isLinkCard:!1,isAllImages:!1},googleBusinessProfile:{content:e.googleBusinessProfile.content,isFeaturedImage:!1,isProductImage:!1,isLinkCard:!1,isAllImages:!1,button:"none"},tumblr:{content:e.tumblr.content,isFeaturedImage:!1,isProductImage:!1,isLinkCard:!1,isAllImages:!1,isVideo:!1}}),ee=e=>({settings:{name:"Untitled schedule",post_interval_value:1,post_interval_type:"hour",started_at:nt,post_publish_order:"4"},post_filters:{filter_by_days:"0",post_type:"post"},accounts:{accountIds:[],tagIds:[]},templates:ct(e)}),L=globalThis.jotaiAtomCache.get("/home/runner/work/bit-social/bit-social/frontend/src/common/globalStates/$scheduleModalData.ts/$scheduleData",te(ee(it)));L.debugLabel="$scheduleData";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function rt(e,t,o){const{data:h,isLoading:p,isFetching:T,refetch:m}=Ce({queryKey:[`get-schedules-${e}`,[t,o]],queryFn:async()=>K(`schedule/${e}${e?"/":""}${t}/${o}`,void 0,void 0,"GET")}),{data:S,pages:c,per_page:v,total:b,current_total:A,current_page:r}=(h==null?void 0:h.data)||{};return{scheduleData:S||[],totalSchedule:b,currentPage:r,totalPages:c,perPage:v,currentTotal:A,isLoadingSchedules:p,refetchSchedules:m,isFetchingSchedules:T}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function lt({size:e="1em",stroke:t=2,className:o}){return a(Me,{children:$("svg",{width:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:`svgIcn ${o}`,children:[a("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function ht(){const e=Be(),{mutateAsync:t,isPending:o}=oe({mutationFn:async h=>K("schedule",{...h},void 0,"POST"),onSuccess:()=>{e.invalidateQueries({queryKey:["all-schedules"]}),e.invalidateQueries({queryKey:["get-calendar-schedules"]})}});return{createSchedule:h=>t(h),createScheduleLoading:o}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function ut(){const{mutateAsync:e,isPending:t}=oe({mutationFn:async o=>{if(!o.id)throw new Error("Schedule ID is undefined");return K(`schedule/${o.id}/update`,{...o},void 0,"POST")}});return{updateSchedule:o=>e(o),isUpdateScheduleLoading:t}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:X}=W,{dateFormat:dt,timeFormat:gt,timeZone:G}=Q(ae),mt=`${dt} ${gt}`,ft=Ie(mt),he=[{value:"Mon",label:"Monday"},{value:"Tue",label:"Tuesday"},{value:"Wed",label:"Wednesday"},{value:"Thu",label:"Thursday"},{value:"Fri",label:"Friday"},{value:"Sat",label:"Saturday"},{value:"Sun",label:"Sunday"}];var pt={name:"z33n32",styles:"max-width:80px"},bt={name:"ypff5m",styles:"min-width:100px"};function yt(){var g,u,s;const[e,t]=x(L),o=Ke(),[h,p]=x(Te),[T,m]=me.useMessage(),S=w(V(G)).format("YYYY-MM-DD HH:mm:ss"),c=(i,l)=>{t(f=>M(f,d=>{d.settings={...d.settings,[i]:l}}))},v=i=>l=>{if(l&&w(l).diff(V(G))<1){p(d=>({...d,startedAt:"Start date & time must be grater than local time"}));return}const f=l==null?void 0:l.format("YYYY-MM-DD HH:mm:ss");if(f)return h.startedAt&&p(d=>({...d,startedAt:""})),c(i,f)},b=i=>l=>{if(i==="sleep_days"&&Array.isArray(l)&&he.length===l.length){T.open({type:"warning",content:"Minimum one day required for post "});return}c(i,l)},A=i=>{const{name:l,value:f}=i.target;c(l,f)},r=i=>(l,f)=>{if(l===void 0){t(d=>M(d,C=>{delete C.settings.sleep_time}));return}c(i,f)};return $(k,{layout:"vertical",children:[m,a(k.Item,{label:"Name",children:a(ce,{placeholder:"Enter a name",type:"text",name:"name",value:(g=e.settings)==null?void 0:g.name,onChange:A})}),a(k.Item,{label:"Start date & time",children:$(E,{direction:"vertical",children:[a(Ze,{onChangeDate:v,stateData:e,type:"SCHEDULE"}),h.startedAt&&$(X,{type:"danger",children:[h.startedAt," "]}),$(X,{mark:!0,children:["Local time: ",w(S).format(ft)," ( ",G,")"]})]})}),a(k.Item,{label:"Post interval",style:{margin:"10px 0"},children:$(E,{children:[a(ce,{css:pt,type:"number",min:1,name:"post_interval_value",onChange:A,value:e.settings.post_interval_value}),a(H,{value:e.settings.post_interval_type,onChange:b("post_interval_type"),options:o,css:bt})]})}),e.id&&e.settings.started_at&&w(e.settings.started_at).diff(V(G))<1&&a(Ye,{message:$(Y,{children:["If your start time has passed, updating the interval will set your next post to local time plus the new interval! For example, current time 06:00 PM, updated Post interval: 2 hours. Next post will be at 08:00 PM."," ",a(W.Link,{href:"https://bit-social.com/docs/bit-social/schedule-wordpress-posts-on-social-media/#if-you-update-your-post-interval",target:"_blank",rel:"noopener noreferrer",underline:!0,children:"Visit our documentation"})]}),type:"info",showIcon:!0}),a(k.Item,{label:"Order posts by",children:a(H,{value:e.settings.post_publish_order,onChange:b("post_publish_order"),options:[{label:"Randomly without duplicates",value:"1"},{label:"Randomly",value:"2"},{label:"Start from the oldest to new posts",value:"3"},{label:"Start from the latest to old posts",value:"4"}]})}),a(k.Item,{children:$(E,{direction:"vertical",children:[a(E,{children:a(X,{children:"Set a sleep timer "})}),a(Le.RangePicker,{onChange:r("sleep_time"),format:"HH:mm",value:(u=e.settings.sleep_time)!=null&&u[0]&&((s=e.settings.sleep_time)!=null&&s[1])?[w(e.settings.sleep_time[0],"HH:mm"),w(e.settings.sleep_time[1],"HH:mm")]:void 0})]})}),a(k.Item,{label:"Set sleep days",children:a(H,{placeholder:"Select sleep days",mode:"multiple",allowClear:!0,value:e.settings.sleep_days,onChange:b("sleep_days"),options:he})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Ct(e){const{data:t,isLoading:o}=Ce({queryKey:["categories",e],queryFn:async()=>K("categories",void 0,{postType:e},"GET")});return{categoriesAndTags:t==null?void 0:t.data,loadingCategories:o}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Tt(){const{mutateAsync:e,isPending:t}=oe({mutationFn:async o=>K("filtered-posts",{...o},void 0,"POST")});return{postFilter:o=>e(o),loadingPostFilter:t}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Title:vt}=W,At=[{label:"All times",value:"0"},{label:"Today",value:"1"},{label:"last 7 days",value:"7"},{label:"last 15 days",value:"15"},{label:"last 30 days",value:"30"},{label:"last 90 days",value:"90"},{label:"last 180 days",value:"180"},{label:"last 365 days",value:"365"},{label:"custom date range",value:"-1"}];function _t(e,t){return t.label.toLowerCase().includes(e.toLowerCase())}function $t(){const{token:e}=fe.useToken(),[t,o]=x(L),{RangePicker:h}=Oe,{postTypes:p,loadingPostType:T}=Qe(),[m,S]=N.useState([]),{postFilter:c,loadingPostFilter:v}=Tt(),{categoriesAndTags:b,loadingCategories:A}=Ct(t.post_filters.post_type||""),{isProClient:r}=R(se),g=je(xe),u=p&&Object.values(p).map(n=>({label:$(Y,{children:[n.label," ",n.name!=="post"&&!r&&a(Fe,{color:"#ff8609",size:16,name:"crown"})]}),value:n.name})),s=b?[{label:"Categories",options:b.categories.map(n=>({label:n.name,value:n.id}))},{label:"Tags",options:b.tags.map(n=>({label:n.name,value:n.id}))}]:[],i=(n,y)=>{o(_=>M(_,D=>{D.post_filters={...D.post_filters,[n]:y}}))},l=n=>y=>{if(n==="filter_by_days")if(y==="0")i("custom_date_range","");else{const _=w();let D=Number.parseInt(y,10);(y==="-1"||y==="1")&&(D=0);const P=_.subtract(D,"day");i("custom_date_range",[P.format("YYYY-MM-DD"),_.format("YYYY-MM-DD")])}if(!r&&n==="post_type"&&y!=="post"){g(!0);return}n==="post_type"&&o(M(_=>{delete _.post_filters.categories_and_tags})),i(n,y)},f=n=>(y,_)=>{i("filter_by_days","-1"),i(n,_)},d=n=>{i("specific_postIds",n)},C=async()=>{const n=await c(t.post_filters);S((n==null?void 0:n.data)||[])};return N.useEffect(()=>{C()},[t.post_filters]),$(Y,{children:[$(k,{layout:"vertical",children:[$(k.Item,{label:"By the published time of the posts",required:!0,children:[a(H,{value:t.post_filters.filter_by_days,placeholder:"Select publish date",onChange:l("filter_by_days"),options:At}),t.post_filters.filter_by_days!=="0"&&t.post_filters.custom_date_range&&a(h,{style:{marginTop:8},allowClear:!1,onChange:f("custom_date_range"),value:[w(t.post_filters.custom_date_range[0],"YYYY-MM-DD"),w(t.post_filters.custom_date_range[1],"YYYY-MM-DD")]})]}),a(k.Item,{label:"By post type",children:a(H,{placeholder:"Select post type",onChange:l("post_type"),options:u,loading:T,value:t.post_filters.post_type,allowClear:!0})}),a(k.Item,{label:"By the post category and tag",children:a(H,{placeholder:"Select category",onChange:l("categories_and_tags"),options:s,loading:A,value:t.post_filters.categories_and_tags,allowClear:!0})}),a(k.Item,{label:"Select Specific Post",children:a(H,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Post ID: Post Title",onChange:d,loading:v,value:t.post_filters.specific_postIds,options:m,showSearch:!0,filterOption:(n,y)=>y?_t(n,y):!1})})]}),$(vt,{css:ve({marginBottom:"0 !important",paddingTop:6,position:"sticky",bottom:0,backgroundColor:e.colorBgElevated},"",""),level:5,children:["Posts matched by current filters: ",m==null?void 0:m.length]})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const St=e=>{const t=new Set(["content","button"]);return Object.keys(e).filter(o=>!t.has(o))},we=(e,t)=>St(t[e]);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ue={isFeaturedImage:{name:"Featured Image",tooltip:"Enable to the post featured image shared"},isProductImage:{name:"Product Image",tooltip:"Enable to the product image shared"},isLinkCard:{name:"Link Card",tooltip:"Enable to the post link shared as a card"},isAllImages:{name:"All Images",tooltip:"Enable to the post all images shared"},isVideo:{name:"Video",tooltip:"Enable to the post video shared"}};function Pe({scheduleData:e,handleSwitch:t,platform:o,types:h}){return h.map(p=>a(Ee,{title:ue[p].tooltip,children:a(ze,{checked:e.templates[o][p],onChange:T=>{t(p,T.target.checked)},children:ue[p].name})},p))}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Dt(){const[e,t]=x(L),{isProClient:o}=R(se),h=v=>{t(b=>M(b,A=>{A.templates.facebook.content=v}))},p=we("facebook",e.templates),T=(v,b)=>{t(A=>M(A,r=>{p.forEach(g=>{r.templates.facebook[g]=!1}),r.templates.facebook[v]=b}))},c=o?["isFeaturedImage","isProductImage","isLinkCard","isAllImages"]:["isFeaturedImage","isLinkCard"];return $(Y,{children:[a(ye,{rows:6,onChange:h,value:e.templates.facebook.content,label:"Customize post message",wrapperClassName:"mb-4"}),a(E,{wrap:!0,className:"mb-3",children:a(Pe,{platform:"facebook",scheduleData:e,handleSwitch:T,types:c})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function wt(){const[e,t]=x(L),{isProClient:o}=R(se),h=v=>{t(b=>M(b,A=>{A.templates.linkedin.content=v}))},p=we("linkedin",e.templates),T=(v,b)=>{t(A=>M(A,r=>{p.forEach(g=>{r.templates.linkedin[g]=!1}),r.templates.linkedin[v]=b}))},c=o?["isFeaturedImage","isProductImage","isLinkCard","isAllImages"]:["isFeaturedImage","isLinkCard"];return $(Y,{children:[a(ye,{rows:6,onChange:h,value:e.templates.linkedin.content,label:"Customize post message",wrapperClassName:"mb-4"}),a(E,{wrap:!0,className:"mb-3",children:a(Pe,{platform:"linkedin",scheduleData:e,handleSwitch:T,types:c})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Pt({platform:e}){switch(e){case"facebook":return a(Dt,{});case"linkedin":return a(wt,{})}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function kt({platform:e}){return a(Pt,{platform:e})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Mt=(e,t)=>[...new Set(e==null?void 0:e.filter(o=>t==null?void 0:t.includes(o.id)).map(o=>o.platform))],It=e=>e.map(t=>({key:t,label:a("span",{title:t,children:a(Xe,{name:t,size:32})}),children:a(kt,{platform:t})}));function jt(){const e=R(L),{activeAccounts:t}=Re(),o=N.useMemo(()=>{const h=Mt(t,e.accounts.accountIds);return It(h)},[t,e.accounts.accountIds]);return!o||!o.length?a(W.Title,{type:"secondary",level:4,style:{textAlign:"center"},children:"Please select an account"}):a(pe,{tabBarGutter:8,items:o})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function xt(){const[e,t]=x(L),{accounts:o}=Je(),h=p=>{t(T=>M(T,m=>{m.accounts=p}))};return N.useEffect(()=>{h(e.accounts)},[]),o.length?$(Ne,{gutter:20,children:[a(re,{span:10,children:$(Y,{children:[$(He,{justify:"space-between",className:"mb-1",children:[a(W.Title,{level:5,children:"Accounts"}),a(le,{})]}),a(We,{selectedAccount:e.accounts,setSelectedAccount:h})]})}),a(re,{span:14,children:a(jt,{})})]}):$(Y,{children:[a(Ge,{textLevel:4,iconSize:40}),a("div",{style:{textAlign:"center"},children:a(le,{})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ft=[{label:"Settings",key:"1",children:a(yt,{})},{label:"Post Filter",key:"2",children:a($t,{})},{label:"Accounts & Template",key:"3",children:a(xt,{})}];function Yt({handleTabActive:e,tabActive:t,token:o}){return a("div",{style:{paddingInline:24},children:a(pe,{defaultActiveKey:"1",className:"sticky-tab",onChange:e,activeKey:t,items:Ft,css:ve({"& .ant-tabs-nav":{backgroundColor:o.colorBgElevated}},"","")})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};w.extend(Se);w.extend(_e);const{timeZone:Lt}=Q(ae);function Qt({btnTitle:e,isScheduleModalOpen:t,setIsScheduleModalOpen:o}){const{token:h}=fe.useToken(),[p,T]=x(L),m=N.useId(),[S,c]=N.useState("1"),{createSchedule:v,createScheduleLoading:b}=ht(),{updateSchedule:A,isUpdateScheduleLoading:r}=ut(),[g,u]=me.useMessage(),[s]=Ve(),i=Number(s.get("page"))||1,l=Number(s.get("limit"))||10,[f]=x(De),{refetchSchedules:d}=rt(f,i,l),{socialTemplates:C}=qe(),n=R(be),[y,_]=x(Te);N.useEffect(()=>{!C||t.type!=="Create"||T(I=>M(I,O=>{Object.keys(O.templates).forEach(B=>{const j=C==null?void 0:C[B],z=O.templates[B],ie=Object.keys(z).filter(Z=>Z!=="content"&&Z!=="button"),ne=j==null?void 0:j.postingType;z.content=(j==null?void 0:j.content)||"",B==="googleBusinessProfile"&&"button"in z&&j&&"button"in j&&(z.button=j.button||"none"),ie.forEach(Z=>{Z in z&&(z[Z]=!1)}),ie.includes(ne)&&(z[ne]=!0)})}))},[C,t.open]);const D=(I,O)=>{var q,B;return I.settings.name===""?(g.open({type:"error",content:"name required"}),!1):I.settings.started_at===""?(g.open({type:"error",content:"start time required"}),!1):(q=I.accounts.accountIds)!=null&&q.length?(B=y==null?void 0:y.startedAt)!=null&&B.length?(g.open({type:"error",content:y.startedAt}),O("1"),!1):!0:(g.open({type:"error",content:"No account selected"}),O("3"),!1)},P=()=>{c("1");const I=w(V(Lt)).format("YYYY-MM-DD HH:mm:ss");T(O=>M(O,q=>{q.settings.started_at=I})),o({open:!0,type:"Create"})},F=async()=>{D(p,c)&&(await(p.id?A(p):v(p)),d(),o({open:!1,type:"Close"}),c("1"),T(ee(n)))},U=()=>{c("1"),o({open:!1,type:"Close"}),_({}),T(ee(n))},ke=I=>{c(I)};return $(Y,{children:[u,e&&a(J,{onClick:P,size:"large",type:"primary",icon:a(lt,{size:12}),children:e}),a(Ue,{width:S==="3"?800:600,styles:{body:{maxHeight:"calc(100vh - 160px)",overflow:"auto",marginInline:-24}},title:`${t==null?void 0:t.type} schedule`,open:t.open,onCancel:U,confirmLoading:b||r,maskClosable:!1,centered:!0,footer:$(E,{children:[a("div",{className:"pr-2",children:a(et,{type:"message"})}),a(J,{onClick:U,children:"Cancel"},"back"),a(J,{type:"primary",loading:b||r,onClick:F,children:p.id?"Update":"Create"},"Ok")]}),children:a(Yt,{handleTabActive:ke,tabActive:S,token:h})},`hello ${m}`)]})}export{L as $,Qt as C,Se as a,De as b,_e as t,rt as u};
